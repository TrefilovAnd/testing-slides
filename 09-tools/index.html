<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Tools</title>

    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/yandex.css">
    <link rel="stylesheet" href="../css/user.css">
    <link rel="stylesheet" href="../css/zenburn.css">
</head>
<body>
<div class="reveal"><div class="slides">

<section>
    <h1>Tools</h1>
    <p>ESlint. Code coverage. Load testing. Continuous integration</p>
    <p class="author">Жигалов Сергей</p>
</section>

<section>
    <section>
        <h3>ESlint</h3>
        <blockquote cite="http://eslint.org/">
            The pluggable linting utility for JavaScript and JSX
            <img src="images/eslint-logo-300x300.png" alt="eslint-logo">
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Линтинг</span> Кодстайл</h3>
        <pre class="js"><code data-trim>
var firstName="Sergey", secondName;
let params ={
    language: 'JavaScript', testable:true,
    version: 'ES2016'
};
        </code></pre>
        <img src="images/eslint-code-style.jpg" alt="eslint-code-style" class="fragment">
    </section>

    <section>
        <h3><span class="gray">Линтинг</span> Ошибки</h3>
        <pre class="js"><code data-trim>
function getPokerHand(dice) {
    if (Array.isArray(dice))
        console.log('Dise is', typeof dice);
        throw new Error('Dice is not array');

    return 'Покер';
}
        </code></pre>
        <img src="images/eslint-errors.jpg" alt="eslint-errors" class="fragment">
    </section>

    <section>
        <h3><span class="gray">Линтинг</span> Неиспользуемые переменные</h3>
        <pre class="js"><code data-trim>
/**
 * Represents a sum
 *
 * @param a The first number.
 * @param {number} b
 */
function sum(a, b) {
    return a + c;
}
        </code></pre>
        <img src="images/eslint-unused-vars.jpg" alt="eslint-unused-vars" class="fragment">
    </section>
</section>

<section>
    <section>
        <h3><span class="gray">ESlint</span> Установка</h3>

        <pre class="bash"><code data-trim>
# Установка eslint
npm install eslint --save-dev

# Установка парсера JavaScript для ESNext
npm install babel-eslint --save-dev
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">ESlint</span> Конфигурация</h3>

        <pre class="js"><code data-trim>
// .eslintrc.json

{
    "env": {
        "es6": true,
        "node": true
    },
    "parser": "babel-eslint",
    "rules": { /* ... */}
}
        </code></pre>

        <pre class="fragment bash"><code data-trim>
./node_modules/.bin/eslint --init
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">ESlint</span> Пресеты</h3>

        <ul>
            <li><code>eslint-config-airbnb</code></li>
            <li><code>eslint-config-google</code></li>
            <li><code>eslint-config-idiomatic</code></li>
            <li><code>eslint-config-jquery</code></li>
            <li><code>...</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">ESlint</span> Запуск</h3>

        <pre class="console bash"><code data-trim data-noescape>
./node_modules/.bin/eslint .

<img src="images/eslint-code-style.jpg" alt="images/eslint-code-style">
        </code></pre>
    </section>


    <section>
        <h3><span class="gray">ESlint</span> <code>--fix</code></h3>

        <h4>До</h4>
        <pre class="js"><code data-trim>
var firstName="Sergey", secondName;
let params ={
    language: 'JavaScript', testable:true,
    version: 'ES2016'
};
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">ESlint</span> <code>--fix</code></h3>

        <h4>После</h4>
        <pre class="js"><code data-trim>
let firstName = 'Sergey',
    secondName;
const params = {
    language: 'JavaScript', testable: true,
    version: 'ES2016'
};
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>Code coverage</h3>
    </section>

    <section
        data-background-image="images/coverage-100.jpg"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/coverage-95.jpg"
        data-background-size="contain">
    </section>

    <section>
        <h3><code>istanbul</code></h3>
        <pre class="console"><code data-trim>
# Установка istanbul
npm install istanbul --save-dev

# Запуск istanbul
./node_modules/.bin/istanbul cover
    ./node_modules/.bin/_mocha
    qa-task-03/tests

# Открываем отчет с результатом coverage
open coverage/lcov-report/index.html
        </code></pre>
        <a href="http://gotwarlost.github.io/istanbul/public/coverage/lcov-report/index.html">DEMO</a>
    </section>

    <section>
        <h3><span class="gray"><code>istanbul</code></span> Отчет</h3>
        <pre class="console"><code>
./node_modules/.bin/istanbul cover ...

====== Coverage summary =======
Statements   : 95.24% ( 20/21 )
Branches     : 93.75% ( 15/16 )
Functions    : 100% ( 3/3 )
Lines        : 95.24% ( 20/21 )
===============================
        </code></pre>
    </section>

    <section
        data-background-image="images/coverage-statement.jpg"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/coverage-branch.jpg"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/coverage-function.jpg"
        data-background-size="contain">
    </section>

    <section>
        <h3><span class="gray"><code>istanbul</code></span> 100%</h3>
        <blockquote>
            Высокий ковередж не означает хорошее покрытие тестами
        </blockquote>
    </section>

    <section
        data-background-image="images/single-other.png"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/multiple-other.png"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/single-unit-coverage.png"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/multiple-unit-coverage.png"
        data-background-size="contain">
    </section>
</section>

<section>
    <section>
        <h3>Пример</h3>
        <pre class="js size-S"><code data-trim>
function playPoker(firstDice, secondDice) {
    const first = getPokerHand(firstDice);
    const second = getPokerHand(secondDice);

    const compareHands =
        pokerHands.indexOf(first) -
        pokerHands.indexOf(second);

    return compareHands === 0
        ? 'Ничья'
        : compareHands > 0 ? 'Первый' : 'Второй';
}
        </code></pre>
    </section>

    <section>
        <h3>Тесты</h3>
        <pre class="js size-XS"><code data-trim>
describe('playPoker', () => {
    it('should return `Ничья` for equal poker hand', () => {
        const actual = playPoker([1, 1, 2, 3, 4], [1, 1, 2, 3, 5]);

        assert.equal(actual, 'Ничья');
    });

    it('should return `Первый` when first hand great then second', () => {
        const actual = playPoker([1, 1, 1, 1, 4], [1, 1, 1, 3, 4]);

        assert.equal(actual, 'Первый');
    });

    /* ... */
});
        </code></pre>
    </section>

    <section
        data-background-image="images/coverage-other-100.jpg"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/coverage-other.jpg"
        data-background-size="contain">
    </section>

    <section>
        <h3><code>unit-coverage</code></h3>
        <pre class="console"><code>
# Устанавливаем unit-coverage
npm install --save-dev unit-coverage

# Запускаем ковередж
node_modules/.bin/unit-coverage run
    -s 'qa-task-03/src/**'
    -t 'qa-task-03/tests/**'
    -S relative
    -O sources=qa-task-03/src
    -O tests=qa-task-03/tests
    -- --recursive qa-task-03/tests/
        </code></pre>
    </section>

    <section
        data-background-image="images/coverage-unit-coverage.jpg"
        data-background-size="contain">
    </section>
</section>

<section>
    <h3>Почитать</h3>
    <ul>
        <li><a href="http://eslint.org/">eslint.org</a></li>
    </ul>
</section>

</div></div>

<script src="../js/head.min.js"></script>
<script src="../js/reveal.js"></script>

<script>
// More info https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    controls: false,
    slideNumber: 'c',
    history: true,
    margin: 0,
    width: 960,
    height: 700,

    // More info https://github.com/hakimel/reveal.js#dependencies
    dependencies: [
        { src: '../plugin/notes/notes.js', async: true },
        { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
    ]
});
</script>
</body>
</html>
