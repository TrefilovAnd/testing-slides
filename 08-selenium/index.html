<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Selenium</title>

    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/yandex.css">
    <link rel="stylesheet" href="../css/user.css">
    <link rel="stylesheet" href="../css/zenburn.css">
</head>
<body>
<div class="reveal"><div class="slides">

<section>
    <h1>Автотесты</h1>
    <p>Selenium</p>
    <p class="author">Жигалов Сергей</p>
</section>

<section>
    <section>
        <h3>Автотесты или ручное тестирование?</h3>
        <img src="images/choice.jpg" alt="choice">
    </section>

    <section>
        <h3>Ручное тестирование</h3>
        <ul>
            <li class="fragment">Интерфейс приложения часто меняется</li>
            <li class="fragment">Быстро</li>
            <li class="fragment">Эффективно в краткосрочной перспективе</li>
        </ul>
    </section>

    <section>
        <h3>Автотесты</h3>
        <ul>
            <li class="fragment">проводить чаще регрессионное тестирование</li>
            <li class="fragment">отчет о состоянии продукта</li>
            <li class="fragment">обнаружить ошибки, которые были пропущены на стадии ручного тестирования</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>Selenium</h3>
        <blockquote cite="https://selenium2.ru/docs/selenium-ide.html">
            это инструмент для автоматизированного управления браузерами
        </blockquote>
    </section>

    <section>
        <h3>Selenium</h3>
        <table>
            <tr>
                <td><img src="images/selenium-ide-logo.png" alt="selenium-ide"></td>
                <td>Selenium IDE</td>
            </tr>
            <tr>
                <td><img src="images/selenium-logo.png" alt="selenium-web-driver"></td>
                <td>Selenium WebDriver</td>
            </tr>
            <tr>
                <td><img src="images/selenium-grid-logo.png" alt="selenium-server"></td>
                <td>Selenium Server + Selenium Grid</td>
            </tr>
        </table>
    </section>

    <section>
        <h3>Краткая история Selenium</h3>
        <blockquote cite="https://selenium2.ru/docs/introduction.html">
            В 2004 году, Джейсон Хаггис ... ядро было реализовано на JavaScript,
            многие вещи было невозможно осуществить из-за ограничений
            безопасности браузеров ... Selenium
        </blockquote>
    </section>

    <section>
        <h3>Краткая история Selenium</h3>
        <blockquote cite="https://selenium2.ru/docs/introduction.html">
            В 2006 году, Саймон Стюарт ... инструмент для тестирования,
            который бы общался с браузером используя
            нативные методы операционной системы и браузера ... WebDriver
        </blockquote>
    </section>

    <section>
        <h3>Краткая история Selenium</h3>
        <blockquote cite="https://selenium2.ru/docs/introduction.html">
            В 2008 году, слияние Selenium и WebDriver ...
            Selenium 2 (или Selenium Webdriver)
        </blockquote>
    </section>

    <section>
        <h3>Поддерживаемые браузеры и платформы</h3>
        <ul>
            <li>Google Chrome</li>
            <li>Microsoft Internet Explorer</li>
            <li>Microsoft Edge</li>
            <li>Mozilla Firefox</li>
            <li>Opera</li>
            <li>HtmlUnit</li>
            <li>PhantomJS</li>
            <li>Android (with Selendroid or appium)</li>
            <li>iOS (with ios-driver or appium)</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>Selenium IDE</h3>
        <blockquote cite="https://selenium2.ru/docs/selenium-ide.html">
             (Integrated Development Environment, интегрированная среда разработки) —
             это инструмент, используемый для разработки тестовых сценариев.
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Установка</h3>
        <a href="https://addons.mozilla.org/en-US/firefox/addon/selenium-ide/">
            <img src="images/firefox.png" alt="firefox" width="100"><br>
            addons.mozilla.org
        </a>
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Запуск</h3>
        <img src="images/selenium-ide-run.jpg" alt="selenium-ide-run">
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Интерфейс</h3>
        <img src="images/selenium-ide-view.jpg" alt="selenium-ide-view">
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Выполнение теста</h3>
        <img src="images/selenium-ide-lodash.gif" alt="selenium-ide-lodash" class="fragment">
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Сценарий теста</h3>
        <table cellpadding="1" cellspacing="1" border="1">
            <thead>
            <tr><td rowspan="1" colspan="3">lodash</td></tr>
            </thead><tbody>
            <tr>
            	<td>open</td>
            	<td>/docs/4.17.4</td>
            	<td></td>
            </tr>
            <tr>
            	<td>sendKeys</td>
            	<td>css=input[type=&quot;search&quot;]</td>
            	<td>filter</td>
            </tr>
            <tr>
            	<td>click</td>
            	<td>css=.react-menu-container li:not(.hidden)&gt;a</td>
            	<td></td>
            </tr>
            <tr>
            	<td>assertLocation</td>
            	<td>https://lodash.com/docs/4.17.4#filter</td>
            	<td></td>
            </tr>
            </tbody>
        </table>
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Выполнение теста</h3>
        <img src="images/selenium-ide-expert.jpg" alt="selenium-ide-expert" width="650">
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Выполнение теста</h3>
        <img src="images/selenium-ide-expert.gif" alt="selenium-ide-expert" class="fragment">
    </section>

    <section>
        <h3><span class="gray">Selenium IDE</span> Сценарий теста</h3>
        <table cellpadding="1" cellspacing="1" border="1">
        <thead>
        <tr><td rowspan="1" colspan="3">expert-hello-test</td></tr>
        </thead><tbody>
        <tr>
        	<td>open</td>
        	<td>/adv/expert/exam/hello</td>
        	<td></td>
        </tr>
        <tr>
        	<td>click</td>
        	<td>css=.checkbox__control</td>
        	<td></td>
        </tr>
        <tr>
        	<td>clickAndWait</td>
        	<td>link=Начать тестирование</td>
        	<td></td>
        </tr>
        <tr>
        	<td>click</td>
        	<td>css=.radiobox__control</td>
        	<td></td>
        </tr>
        <tr>
        	<td>click</td>
        	<td>//button[@type='button']</td>
        	<td></td>
        </tr>
        <tr>
        	<td>waitForText</td>
        	<td>css=div.attempt-progress__text</td>
        	<td>9% пройдено</td>
        </tr>
        <td rowspan="1" colspan="3">...</td>
        <tr>
        	<td>waitForText</td>
        	<td>link=Вернуться на главную Сертификации</td>
        	<td>Вернуться на главную Сертификации</td>
        </tr>
        </tbody></table>
    </section>
</section>

<section>
    <section>
        <h3>Команды Selenium</h3>
        <ul>
            <li class="fragment">Действия</li>
            <li class="fragment">Считывания</li>
            <li class="fragment">Проверки</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Команды Selenium</span> Действия</h3>
        <ul>
            <li><code>click</code></li>
            <li><code>dragAndDrop</code></li>
            <li><code>type</code></li>
            <li><code>submit</code></li>
            <li><code>sendKeys</code></li>
            <li><code>...</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Команды Selenium</span> Действия<code>AndWait</code></h3>
        <ul>
            <li><code>clickAndWait</code></li>
            <li><code>dragAndDropAndWait</code></li>
            <li><code>typeAndWait</code></li>
            <li><code>submitAndWait</code></li>
            <li><code>sendKeysAndWait</code></li>
            <li><code>...AndWait</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Команды Selenium</span> Считывания</h3>

        <table><thead>
            <tr>
                <td>Команда</td>
                <td>Цель</td>
                <td>Значение</td>
            </tr>
        </thead><tbody>
            <tr class="fragment">
                <td><code>store</code></td><td><code>Степан</code></td><td><code>name</code></td>
            </tr>
            <tr class="fragment">
                <td><code>storeElementPresent</code></td><td><code>//div/form</code></td><td><code>hasForm</code></td>
            </tr>
            <tr class="fragment">
                <td><code>storeText</code></td><td><code>//h1</code></td><td><code>title</code></td>
            </tr>
            <tr class="fragment">
                <td><code>storeEval</code></td><td><code>storedVars['title'].toLowerCase()</code></td><td><code>header</code></td>
            </tr>
        </tbody></table>
    </section>

    <section>
        <h3><span class="gray">Команды Selenium</span> Проверки</h3>

        <table><thead>
            <tr>
                <td>Команда</td>
                <td>Цель</td>
                <td>Значение</td>
            </tr>
        </thead><tbody>
            <tr class="fragment">
            	<td><code>assertValue</code></td>
            	<td><code>id=result</code></td>
            	<td><code>15120</code></td>
            </tr>
            <tr class="fragment">
            	<td><code>verifyValue</code></td>
            	<td><code>id=result</code></td>
            	<td><code>15120</code></td>
            </tr>
            <tr class="fragment">
            	<td><code>waitForValue</code></td>
            	<td><code>id=result</code></td>
            	<td><code>15120</code></td>
            </tr>
        </tbody></table>
    </section>

    <section>
        <h3><span class="gray">Команды Selenium</span> Аргументы</h3>

        <table><thead>
            <tr>
                <td>Команда</td>
                <td>Цель</td>
                <td>Значение</td>
            </tr>
        </thead><tbody>
            <tr class="fragment">
                <td>goBackAndWait</td><td>&nbsp;</td><td>&nbsp;</td>
            </tr>
            <tr class="fragment">
                <td>verifyTextPresent</td><td>&nbsp;</td><td>Добро пожаловать на мою страницу</td>
            </tr>
            <tr class="fragment">
                <td>type</td><td>id=phone</td><td>(555) 666-7066</td>
            </tr>
            <tr class="fragment">
                <td>type</td><td>id=address1</td><td>${myVariableAddress}</td>
            </tr>
        </tbody></table>
    </section>
</section>

<section>
    <section>
        <h3>Локатор</h3>
        <blockquote cite="https://selenium2.ru/docs/selenium-ide.html" class="fragment">
             цель, идентифицирующую элемент на странице веб-приложения
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Локатор</span> Идентификатор</h3>
        <ul>
            <li class="fragment"><code>identifier=loginForm</code></li>
            <li class="fragment"><code>id=loginForm</code></li>
            <li class="fragment"><code>name=username</code></li>
            <li class="fragment"><code>link=Начать тестирование</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Локатор</span> XPath</h3>
        <ul>
            <li class="fragment"><code>xpath=/html/body/form[1]</code></li>
            <li class="fragment"><code>//form[1]</code></li>
            <li class="fragment"><code>//form[@id='loginForm']/input[4]</code></li>
            <li class="fragment"><code>//input[@name='continue'][@type='button']</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Локатор</span> DOM</h3>
        <ul>
            <li class="fragment"><code>dom=document.getElementById('loginForm')</code></li>
            <li class="fragment"><code>dom=document.forms[0]</code></li>
            <li class="fragment"><code>document.forms[0].elements[3]</code></li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Локатор</span> CSS</h3>
        <ul>
            <li class="fragment"><code>css=form#loginForm</code></li>
            <li class="fragment"><code>css=input[name="username"]</code></li>
            <li class="fragment"><code>css=#loginForm input[type="button"] </code></li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>Соответствия шаблону</h3>
        <blockquote cite="https://selenium2.ru/docs/selenium-ide.html">
            Шаблоны дают пользователю возможность описывать искомый текст
            с помощью специальных символов, вместо того,
            чтобы указывать этот текст в точности
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Шаблоны</span> Подстановка</h3>
        <ul>
            <li class="fragment">glob:*кот*</li>
            <li class="fragment">glob:[0-9]</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Шаблоны</span> Регулярные выражения</h3>
        <ul>
            <li class="fragment">regexpi:.*кот.*</li>
            <li class="fragment">regexp:\d</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">Шаблоны</span> Точное совпадение</h3>
        <ul>
            <li class="fragment">exact:котёнок</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3><a href="https://urfu-2016-convertor.herokuapp.com/convert.html">DEMO</a></h3>
    </section>

    <section
        data-background-image="images/selenium-ide-convertor-record.gif"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/selenium-ide-convertor-slow.gif"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/selenium-ide-convertor-fast.gif"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/selenium-ide-convertor-wait.gif"
        data-background-size="contain">
    </section>
</section>

<section>
    <section>
        <ul>
            <li><a href="https://www.npmjs.com/package/selenium-webdriver">selenium-webdriver</a></li>
            <li><a href="https://www.npmjs.com/package/webdriverio">webdriverio</a></li>
            <li><a href="https://www.npmjs.com/package/wd">wd</a></li>
        </ul>
    </section>

    <section>
        <h3>Задача</h3>
        <blockquote>
            <ol>
                <li>Открыть http://www.google.com</li>
                <li>Набрать `webdriver`</li>
                <li>Кликнуть по кнопке</li>
            </ol>
        </blockquote>
    </section>

    <section>
        <h3>selenium-webdriverjs</h3>
        <pre class="js"><code data-trim>
driver.get('http://www.google.com');
driver.findElement(webdriver.By.id('q')).sendKeys('webdriver');
driver.findElement(webdriver.By.id('btnG')).click();
        </code></pre>
    </section>

    <section>
        <h3>WD.js</h3>
        <pre class="js"><code data-trim>
browser
    .get("http://www.google.com")
    .elementById('q')
    .sendKeys('webdriver')
    .elementById('btnG')
    .click()
        </code></pre>
    </section>

    <section>
        <h3>webdriverio</h3>
        <pre class="js"><code data-trim>
client
    .url('http://google.com')
    .setValue('#q','webdriver')
    .click('#btnG')
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>webdriverio</h3>
        <h4>Standalone Mode</h4>
        <small class="fragment">Для запуска скриптов</small>
    </section>

    <section>
        <pre class="bash console size-XS"><code data-trim>
# Загружаем selenium-server
curl -O http://selenium-release.storage.googleapis.com/3.0/selenium-server-standalone-3.4.0.jar

# Загружаем и распаковываем geckodriver
curl -L https://github.com/mozilla/geckodriver/releases/download/v0.16.0/geckodriver-v0.16.0-macos.tar.gz | tar xz

# Запускаем selenium-server
java -jar -Dwebdriver.gecko.driver=./geckodriver selenium-server-standalone-3.4.0.jar
        </code></pre>

        <pre class="bash console size-XS fragment"><code data-trim>
# Устанавливаем webdriverio
npm install webdriverio --save-dev

# Редактируем google-script.js
...

# Запускаем google-script.js
node google-script.js
        </code></pre>
    </section>

    <section>
        <pre class="js"><code data-trim>
const webdriverio = require('webdriverio');
const options = {
    desiredCapabilities: {
        browserName: 'firefox'
    }
};
webdriverio
    .remote(options)
    .init()
    .url('http://www.google.com')
    .getTitle()
    .then(title => console.log('Title was: ' + title))
    .end();
        </code></pre>
        <pre class="bash console fragment"><code data-trim>
Title was: Google
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>webdriverio</h3>
        <h4>The WDIO Testrunner</h4>
        <small class="fragment">Для запуска тестов</small>
    </section>

    <section>
        <pre class="bash console"><code data-trim>
./node_modules/.bin/wdio config
        </code></pre>
    </section>

    <section
        data-background-image="images/selenium-wdio-config.gif"
        data-background-size="contain">
    </section>

    <section>
        <pre class="js"><code data-trim>
// tests/google-test.js
const assert = require('assert');

describe('Google page', () => {
    it('should have correct title', () => {
        browser.url('http://www.google.com');

        const actual = browser.getTitle();
        assert.equal(actual, 'Google');
    });
});
        </code></pre>
    </section>

    <section>
        <pre class="bash console"><code data-trim>
./node_modules/.bin/wdio config
        </code></pre>
    </section>

    <section
        data-background-image="images/selenium-wdio-run-example.jpg"
        data-background-size="contain">
    </section>
</section>

<section>
    <section>
        <pre class="js size-XS"><code data-trim>
const assert = require('assert');

describe('Converter page', () => {
    it('should convert value', () => {
        browser.url(
            'https://urfu-2016-convertor.herokuapp.com/convert.html');

        browser.setValue('#value', '1.5');
        browser.setValue('input#from', 'week');
        browser.setValue('#to', 'min');
        browser.click('#send');
        browser.waitForValue('#result', 2000);

        const actual = browser.getValue('#result');
        assert.equal(actual, '15120');
    });
});
        </code></pre>
    </section>

    <section
        data-background-image="images/selenium-wdio-run-converter.gif"
        data-background-size="contain">
    </section>
</section>

<section>
    <section>
        <h3>Selenium Grid</h3>
        <a href="https://saucelabs.com/">https://saucelabs.com/</a>
    </section>

    <section
        data-background-image="images/saucelabs.jpg"
        data-background-size="contain">
    </section>

    <section>
        <h3><span class="gray">saucelabs</span> Переменные окружения</h3>
        <a href="https://wiki.saucelabs.com/display/DOCS/Best+Practice%3A+Use+Environment+Variables+for+Authentication+Credentials">
            Use Environment Variables for Authentication Credentials
        </a>
        <pre class="bash console fragment"><code data-trim>
export SAUCE_USERNAME="your Sauce username"
export SAUCE_ACCESS_KEY="your sauce access key"
        </code></pre>
    </section>

    <section
        data-background-image="images/saucelabs-user-settings.jpg"
        data-background-size="contain">
    </section>

    <section>
        <h3><span class="gray">saucelabs</span> Конфигурация</h3>
        <pre class="bash console"><code data-trim>
./node_modules/.bin/wdio config
        </code></pre>
    </section>

    <section
        data-background-image="images/selenium-sauce-config.gif"
        data-background-size="contain">
    </section>

    <section>
        <h3><span class="gray">saucelabs</span> Таймауты</h3>
        <pre class="js"><code data-trim>
// wdio.conf.js
{
    mochaOpts: {
        timeout: 30000
    }
}
        </code></pre>
        <pre class="bash console fragment"><code data-trim>
./node_modules/.bin/wdio wdio.conf.js
        </code></pre>
    </section>

    <section
        data-background-image="images/saucelabs-tests.jpg"
        data-background-size="contain">
    </section>

    <section
        data-background-image="images/saucelabs-details.jpg"
        data-background-size="contain">
    </section>
</section>

<section>
    <h3>Почитать</h3>
    <ul>
        <li><a href="https://selenium2.ru/docs/selenium-ide.html">Перевод документации по Selenium</a></li>
        <li><a href="https://www.w3.org/TR/xpath/">XML Path Language</a></li>
        <li><a href="https://wiki.saucelabs.com/display/DOCS/Best+Practices+for+Running+Tests">Best Practices for Running Tests</a></li>
        <li><a href="https://github.com/webdriverio/webdriverio/issues/138">webdriverjs vs selenium-wedriverjs</a></li>
        <li><a href="http://webdriver.io/">webdriver.io</a></li>
        <li><a href="https://saucelabs.com/">saucelabs.com</a></li>
        <li><a href="https://wiki.saucelabs.com/display/DOCS/Best+Practice%3A+Use+Environment+Variables+for+Authentication+Credentials">Use Environment Variables for Authentication Credentials</a></li>
    </ul>
</section>

</div></div>

<script src="../js/head.min.js"></script>
<script src="../js/reveal.js"></script>

<script>
// More info https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    controls: false,
    slideNumber: 'c',
    history: true,
    margin: 0,
    width: 960,
    height: 700,

    // More info https://github.com/hakimel/reveal.js#dependencies
    dependencies: [
        { src: '../plugin/notes/notes.js', async: true },
        { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
    ]
});
</script>
</body>
</html>
